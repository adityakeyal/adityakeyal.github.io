<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=msapplication-TileImage content="/ms-icon-144x144.png"><meta name=msapplication-TileColor content="#1793d0"><meta name=theme-color content="#1793d0"><title>Using Github Actions to Publish Github Pages | Random thoughts of a Developer</title><meta property="og:title" content="Using Github Actions to Publish Github Pages - Random thoughts of a Developer"><meta property="og:type" content="article"><meta property="article:published_time" content="2021-01-10T13:30:10+08:00"><meta property="article:modified_time" content="2021-01-10T13:30:10+08:00"><meta name=keywords content="HTML,hugo,CSS"><meta name=description content="Using Github Actions to Publish Github Pages"><meta name=author content><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/favicon-96x96.png><link rel=icon type=image/png sizes=192x192 href=/android-icon-192x192.png><link rel=apple-touch-icon sizes=57x57 href=/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/apple-icon-180x180.png><link rel=stylesheet type=text/css href=/css/hulga.min.css></head><body><div id=main><section class="hero is-primary shadow-hero is-bold"><div class=hero-head><nav class="navbar is-primary"><div class=container><div class=navbar-brand><a class=navbar-item href=https://adityakeyal.github.io/>Random thoughts of a Developer</a>
<a role=button class=navbar-burger data-target=navMenu aria-label=menu aria-expanded=false><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div class=navbar-menu id=navMenu><div class=navbar-end></div></div></div></nav></div><div class=hero-body><header class="container has-text-centered"><h1 class="title post-title">Using Github Actions to Publish Github Pages</h1><h2 class=subtitle><time class=post-meta>2021/01/10</time> ・
<span class="post-tag post-meta"><a href=https://adityakeyal.github.io//categories/github>Github</a></span></h2><div class="tagbox post-meta"><span class=post-tag><a href=https://adityakeyal.github.io//tags/github-actions>#Github Actions</a></span></div></header></div></section><section class=section><div class=container><div class=columns><div class="column is-1 is-hidden-mobile"></div><div class="column is-8"><article class=content id=post-content><h2 id=what-are-github-actions>What are Github Actions</h2><p>Github Actions are the automated CI/CD pipeline provided by Github out of the box.
These are provided Free and can be configured using a YAML file present in the .github/workflows folder.</p><h2 id=what-are-github-pages>What are Github Pages</h2><p>Github pages are static pages which are accessible over http predefined URLs.
There are generally 2 variations of github pages</p><ul><li>User specific (https://<strong>&lt;username></strong>.github.io/)</li><li>Project specific (https://<strong>&lt;username></strong>.github.io/<strong>&lt;project name></strong>)</li></ul><p>A very interesting usecase of github pages is to host a blog (this blog being an example) through the combination of markdown files and static generators</p><h3 id=deploying-user-specific-github-pages>Deploying User specific github pages</h3><p>Generally the user specific pages are deployed in a project which follows the below convention:</p><blockquote><p>The project name should be &lt;username>.github.io
The files should be deployed to the <em>master</em> branch</p></blockquote><p><img src=/github/8de095a3a58949b6b656aa6ff7bdd226.png alt=56972cbff1bb6ab2e7f005b78b886fa7.png></p><h3 id=deploying-project-specific-github-pages>Deploying Project specific github pages</h3><blockquote><p>The files are deployed on a branch with the name <em>gh-pages</em> under the same project</p></blockquote><p><img src=/github/b639e91dee4047c3b8c867ed62845128.png alt=63db3a3fa4c2efd28e06025a94e41dce.png></p><h2 id=deploy-a-blog-as-user-github-page>Deploy a Blog as User Github Page</h2><p>One interesting way to start a blog is to use &ldquo;user specific github pages&rdquo; as a blog. This generally consists of a combination of 2 things</p><ol><li>Blog content in the form of markdown pages (and images)</li><li>A static site generator (coupled with a theme)</li></ol><p>This can be visualized as below:</p><p><img src=/github/bb0679f5445d4e3ca6c78d6cf876ea64.png alt=667465eb7da5a79cde68fe82a24f60b9.png></p><p>Note: While there are many site generators like Jekyll. I liked the simplicity of Hugo (especially the default option of themes hence I went with Hugo.)</p><p>More information on Hugo <a href=https://gohugo.io/>here</a></p><h3 id=structure>Structure</h3><p>When using hugo , the default structure (in the most simple form) consists of the below structure
<img src=/github/34db6b6b3410462397d4a65fc398345f.png alt=4432aac210cd41d91d5df80367d67947.png>
The primary folders of interest are listed below</p><table><thead><tr><th>Folder</th><th>Description</th></tr></thead><tbody><tr><td>content/posts</td><td>Consists of the text content in markdown format</td></tr><tr><td>static/*</td><td>Consists of images referred in the markdown</td></tr><tr><td>themese</td><td>These are different themes available for use (only 1 can be active)</td></tr><tr><td>workflows</td><td>The folder where Github Actions are maintained</td></tr></tbody></table><p>While the 1st 3 are self explanatory, anyone interested can refer to the below sites for more information</p><ul><li><a href=https://gohugo.io/getting-started/>Getting started with Hugo</a></li><li><a href=https://themes.gohugo.io/>Themes in Hugo</a></li><li><a href=https://www.markdownguide.org/getting-started/>Introduction to Markdown</a></li></ul><h3 id=github-actions>Github Actions</h3><p>The most interesting piece of the puzzle is the usage of Github Actions to automate the entire blog. A normal workflow constists of the below</p><ol><li>Update mrkdown file</li><li>Commit markdown and push to Github remote repository</li><li>Github Action automatically builds static site and updates Github pages</li></ol><p>This automation is achieved through the use of <a href=https://github.com/features/actions>Github Actions</a></p><h2 id=github-action-to-deploy-the-blog>Github Action to deploy the blog</h2><h3 id=deployment-file>Deployment File</h3><p>The first step is to create a YAML deployment file in the .github/workflows folder. This file tells github which all actions need to be invoked. A sample file is as below:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#75715e># This is a basic workflow to help you get started with Actions</span>
<span style=color:#f92672>name</span>: <span style=color:#ae81ff>CI</span>

<span style=color:#75715e># Controls when the action will run. </span>
<span style=color:#f92672>on</span>:
  <span style=color:#75715e># Triggers the workflow on push or pull request events but only for the main branch</span>
  <span style=color:#f92672>push</span>:
    <span style=color:#f92672>branches</span>: [ <span style=color:#ae81ff>main ]</span>
  

<span style=color:#75715e># A workflow run is made up of one or more jobs that can run sequentially or in parallel</span>
<span style=color:#f92672>jobs</span>:
  <span style=color:#75715e># This workflow contains a single job called &#34;build&#34;</span>
  <span style=color:#f92672>build</span>:
    <span style=color:#75715e># The type of runner that the job will run on</span>
    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-18.04</span>
    <span style=color:#75715e># Steps represent a sequence of tasks that will be executed as part of the job</span>
    <span style=color:#f92672>steps</span>:
      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Git Checkout</span>
        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v2.3.4</span>
        <span style=color:#f92672>with</span>:
          <span style=color:#f92672>submodules</span>: <span style=color:#66d9ef>true</span>
          <span style=color:#f92672>fetch-depth</span>: <span style=color:#ae81ff>0</span>
           
      <span style=color:#75715e># Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it</span>
      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Setup Hugo</span>
        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>peaceiris/actions-hugo@v2.4.13</span>
        <span style=color:#f92672>with</span>:
          <span style=color:#f92672>hugo-version</span>: <span style=color:#e6db74>&#39;0.79.1&#39;</span>
           
      <span style=color:#75715e># Runs a single command using the runners shell</span>
      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Build</span>
        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>hugo --minify</span>
      <span style=color:#75715e># Deploys the file to repository</span>
      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Deploy</span>
        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>peaceiris/actions-gh-pages@v3.7.3</span>
        <span style=color:#f92672>with</span>:
          <span style=color:#f92672>external_repository</span>: <span style=color:#ae81ff>adityakeyal/adityakeyal.github.io</span>
          <span style=color:#f92672>personal_token</span>: <span style=color:#ae81ff>${{secrets.SECRET_KEY}}</span>
          <span style=color:#f92672>publish_dir</span>: <span style=color:#ae81ff>./public</span>
          <span style=color:#f92672>user_name</span>: <span style=color:#ae81ff>adityakeyal</span>
          <span style=color:#f92672>user_email</span>: <span style=color:#ae81ff>adi.keyal@gmail.com</span>
          <span style=color:#f92672>publish_branch</span>: <span style=color:#ae81ff>master</span>
      
</code></pre></div><h3 id=setting-up-a-secret>Setting up a Secret</h3><p>One of the biggest challenges faced during this setup was to setup a secret key.
By default github actions don&rsquo;t have permission to check in any file. To checkin a file they need special permissions. This can be provided by the below process</p><h4 id=creating-a-personal-access-token>Creating a Personal Access Token</h4><h5 id=step-1>Step 1.</h5><p><img src=/github/33c727a22ff1402a84d3060627707ea6.png alt=ecb4444e44628b4f1391ef1666bc0c0b.png></p><h5 id=step-2-developer-settings>Step 2. Developer Settings</h5><p><img src=/github/e548a1fc061b4cfeb47c6661d4f2a036.png alt=fe9138f232d9336ab50d83f90d024967.png></p><h5 id=step-3-personal-access-token>Step 3. Personal Access Token</h5><p><img src=/github/c1d21b41e62b4ccea04665efbb9f5619.png alt=b316e01c87b64968e9cd9f5bbfbea7f0.png></p><h5 id=step-4-create-a-new-token>Step 4. Create a new Token</h5><p><img src=/github/c58bc7eff59343a59decd7e6d9137208.png alt=2aeb91c21d52890c0add15b7ec8c1e46.png></p><h5 id=step-5-copy-and-save-the-token>Step 5. Copy and save the token</h5><p><img src=/github/1eda766082f6406bb764a99c89e9077a.png alt=467949806f3a0e291139a57e7c2b135c.png></p><h4 id=updating-the-token-to-the-repository>Updating the token to the repository</h4><h5 id=step-1-create-a-new-repository-secret>Step 1. Create a new repository secret</h5><p><img src=/github/c9eaf1e7cf4945a7873af082a7384242.png alt=e82f26b574e9ab74ece65ef6ce12123a.png></p><h5 id=step-2>Step 2.</h5><p>Use this token in the YAML file.</p><blockquote><p><strong>Note:</strong></p><p>By default Github provides a readonly token called <em>GITHUB_TOKEN</em> which has acceess to the current repository. However since the pages are maintained in a separate repository we must create the Personal Access Token.
And to protect any one from accessing the token, the token is saved as above.</p></blockquote></article></div><div class="column is-hidden-mobile"><div class=sidebar id=toc><div class="post post-toc" id=post-toc></div></div></div></div></div></div></section></div><footer class=footer><div class="content has-text-centered"><p>Powered by <a href=https://gohugo.io>Hugo</a>. Theme <a href=https://www.github.com/wlh320/hugo-theme-hulga>Hulga</a></p><p>Copyright © 2020 wlh. All rights reserved.</p></div></footer><script src=https://cdn.jsdelivr.net/npm/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js></script><script>addBackToTop({diameter:42,backgroundColor:"#1793d0",innerHTML:'<svg viewBox="0 0 24 24"><path d="M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"/></svg>',textColor:'#fff'});</script><script type=text/javascript>document.addEventListener('DOMContentLoaded',()=>{const $navbarBurgers=Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'),0);if($navbarBurgers.length>0){$navbarBurgers.forEach(el=>{el.addEventListener('click',()=>{const target=el.dataset.target;const $target=document.getElementById(target);el.classList.toggle('is-active');$target.classList.toggle('is-active');});});}});</script><link id=hlcss rel=stylesheet type=text/css><script>function addCss(url){var link=document.getElementById('hlcss');link.href=url;}
var darkcss="https://adityakeyal.github.io/css/monokailight.css"
var lightcss="https://adityakeyal.github.io/css/monokailight.css"
if(window.matchMedia('(prefers-color-scheme)').media==='not all'){addCss(lightcss);}else if(window.matchMedia("(prefers-color-scheme: dark)").matches){addCss(darkcss);}else{addCss(lightcss);}
window.matchMedia("(prefers-color-scheme: dark)").addListener(e=>e.matches&&addCss(darkcss));window.matchMedia("(prefers-color-scheme: light)").addListener(e=>e.matches&&addCss(lightcss));</script><script src=https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js></script><script>anchors.options={placement:'left',icon:'#'};anchors.add('.content h1, .content h2, .content h3');</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css integrity="sha256-tn6hZ2YGDv0w1/DaFL4MiUoXuAVclrtFZs13ch3TB9M=" crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js integrity="sha256-1qhJwAgsSPVSSjlQVTewHS49eaoAbOz651dveUANVBI=" crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js integrity="sha256-oEuQVLwO5Ii6subChtLbrY5gx7NDRU+UJJ9jvvau+FI=" crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:true},{left:"\\[",right:"\\]",display:true},{left:"$",right:"$",display:false},{left:"\\(",right:"\\)",display:false}]});});</script><link rel=stylesheet type=text/css href=https://adityakeyal.github.io/css/toc.min.css><script src=https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js></script><script>tocbot.init({tocSelector:'.post-toc',contentSelector:'#post-content',headingSelector:'h1, h2, h3',collapseDepth:0,scrollSmooth:true,positionFixedSelector:'.post-toc',fixedSidebarOffset:273,});</script></body></html>